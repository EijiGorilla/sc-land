"use strict";(self.webpackChunksc_land=self.webpackChunksc_land||[]).push([[26964],{4583:(e,t,a)=>{a.r(t),a.d(t,{default:()=>p});var i=a(35143),d=a(91967),s=a(19276),n=a(67993),r=a(46053),o=(a(81806),a(76460),a(47249),a(85842)),l=a(99464),c=a(33377);let h=class extends((0,c.U)(d.default)){constructor(e){super(e),this.savedGraphics=new s.default,this.type="data-capture",this.pendingGraphics=new n.A}get collectionId(){return this.viewModel.collectionId}handleCreate(e){const{state:t,graphic:a,tool:i}=e,d=a?.geometry;if("complete"!==t||!a||!d)return;const{collectionId:n,viewModel:{dataCaptureLayer:r,currentBestFeature:o,imageGeometryField:c,oiObjectIdField:h,activeViewer:p,mode:u},pendingGraphics:v}=this,y=p?.imageSize;o&&c&&n&&h&&r&&y&&"none"!==u&&(function(e,t,a,i,d,n,r,o,c,h){e.sourceLayer=h,e.attributes=e.attributes??{},e.attributes[a]=btoa(JSON.stringify({geometry:(0,l.zT)(t.clone(),c,o).toJSON()})),e.attributes[i]=d.attributes.objectId,n.has(r)||n.set(r,new s.default),n.get(r).add(e)}(a,d,c,h,o,v,n,y,u,r),this.viewModel.emit("after-data-capture-complete",{pendingGraphics:v.get(n)?.toArray()??null}),this.viewModel.sketch?.create(i))}handleDelete(e){const{dataCaptureLayer:t}=this.viewModel;if(!t)return;const{graphics:a}=e;this.pendingGraphics.get(t.id)?.removeMany(a),this.savedGraphics.removeMany(a),this.viewModel.deleteDataCaptureFeatures(function(e,t){return e.map((e=>{let{attributes:a}=e;return t?a[t]:null})).filter(Boolean)}(a,t.objectIdField))}handleDestroy(){const{dataCaptureLayer:e}=this.viewModel;e&&(this.viewModel.stopDataCapture(),this.savedGraphics.removeAll(),this.pendingGraphics=null)}handleUpdate(e){const{toolEventInfo:t,state:a,graphics:i}=e;if(t)this.viewModel.sketch?.undo();else switch(a){case"complete":this.viewModel.emit("deselect-data-capture-features",{graphics:i});break;case"start":this.viewModel.emit("select-data-capture-features",{graphics:i})}}};(0,i._)([(0,r.MZ)()],h.prototype,"collectionId",null),(0,i._)([(0,r.MZ)()],h.prototype,"savedGraphics",void 0),(0,i._)([(0,r.MZ)()],h.prototype,"type",void 0),(0,i._)([(0,r.MZ)()],h.prototype,"pendingGraphics",void 0),h=(0,i._)([(0,o.$)("esri.widgets.OrientedImageryViewer.adapters.sketch.DataCaptureAdapter")],h);const p=h},33377:(e,t,a)=>{a.d(t,{U:()=>o});var i=a(35143),d=a(68134),s=a(46053),n=(a(81806),a(76460),a(47249),a(85842));const r="sketch-handles",o=e=>{let t=class extends e{initialize(){this.addHandles((0,d.watch)((()=>this.viewModel?.sketch),(e=>{this.removeHandles(r),e&&this.addHandles([e.on("create",(e=>this.handleCreate(e))),e.on("update",(e=>this.handleUpdate(e))),e.on("undo",(e=>this.handleUndo(e))),e.on("redo",(e=>this.handleRedo(e))),e.on("delete",(e=>this.handleDelete(e))),e.on("destroy",(()=>this.handleDestroy())),e.on("duplicate",(e=>this.handleDuplicate(e))),(0,d.watch)((()=>e.activeComponent),(e=>{"draw-2d"!==e?.type&&"draw-3d"!==e?.type||(e.elevationLockOnVertexAddDisabled=!0)}),d.syncAndInitial)],r)}),d.syncAndInitial))}handleCreate(e){}handleUpdate(e){}handleUndo(e){}handleRedo(e){}handleDelete(e){}handleDestroy(){}handleDuplicate(e){}};return(0,i._)([(0,s.MZ)()],t.prototype,"type",void 0),(0,i._)([(0,s.MZ)()],t.prototype,"viewModel",void 0),t=(0,i._)([(0,n.$)("esri.widgets.OrientedImageryViewer.mixins.SketchHandlerMixin")],t),t}}}]);
//# sourceMappingURL=26964.9ba0e094.chunk.js.map